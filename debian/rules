#!/usr/bin/make -f

lib_pkgs := calligra-libs

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

export DEB_LDFLAGS_MAINT_APPEND := -Wl,--as-needed

%:
	dh $@ --parallel --with kde --with sodeps

override_dh_auto_configure:
	dh_auto_configure -Skde -- -DKDE4_BUILD_TESTS=OFF -DPRODUCTSET=ALL

override_dh_install:
	dh_movelibkdeinit
	dh_install --list-missing
	#lut and open gl are !arm, this needs made more eloquent
ifeq ($(DEB_HOST_ARCH),i386)
	dh_install --autodest -pkrita usr/lib/kde4/kritalutdocker.so
	dh_install --autodest -pkrita usr/share/kde4/services/calligra/krita_lutdocker.desktop
endif
ifeq ($(DEB_HOST_ARCH),amd64)
	dh_install --autodest -pkrita usr/lib/kde4/kritalutdocker.so
	dh_install --autodest -pkrita usr/share/kde4/services/calligra/krita_lutdocker.desktop
endif

override_dh_strip:
	dh_strip --dbg-package=calligra-dbg

override_dh_shlibdeps:
	dh_shlibdeps $(addprefix -p,$(lib_pkgs)) -- -xkde-runtime -xkdepim-runtime
	dh_shlibdeps --remaining-packages

.PHONY: override_dh_auto_test
